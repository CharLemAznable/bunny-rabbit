-- noinspection SqlNoDataSourceInspectionForFile

-- [queryChargingBalance]
SELECT SA.SERVICE_BALANCE AS balance
      ,SA.SERVICE_UNIT    AS unit
  FROM SERVICE_ACCOUNT    SA
 WHERE SA.SERVICE_CODE    = #chargingType#

-- [updateBalanceByCharge]
UPDATE SERVICE_ACCOUNT    SA
   SET SA.SERVICE_BALANCE = SA.SERVICE_BALANCE + #chargeValue#
 WHERE SA.SERVICE_CODE    = #chargingType#

-- [queryPaymentSequence]
SELECT SAS.SERVICE_USED     AS used
      ,SAS.SERVICE_UNIT     AS unit
  FROM SERVICE_ACCOUNT_SEQ  SAS
 WHERE SAS.SERVICE_CODE     = #chargingType#
   AND SAS.SEQ_ID           = #seqId#

-- [commitPaymentSequence]
UPDATE SERVICE_ACCOUNT_SEQ  SAS
   SET SAS.STATE            = '1'
 WHERE SAS.SERVICE_CODE     = #chargingType#
   AND SAS.SEQ_ID           = #seqId#
   AND SAS.STATE            = '0'

-- [logError]
INSERT INTO SERVICE_ACCOUNT_ERROR_LOG
      (LOG_ID
      ,SEQ_ID
      ,SERVICE_CODE
      ,ERROR_CONTENT)
SELECT #logId#
      ,#seqId#
      ,SA.SERVICE_CODE
      ,#errorContent#
  FROM SERVICE_ACCOUNT SA
 WHERE SA.SERVICE_CODE = #chargingType#
